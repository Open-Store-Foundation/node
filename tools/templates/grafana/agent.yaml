metrics:
  wal_directory: '/tmp/grafana-agent-wal'
  global:
    scrape_interval: 30s
    remote_write:
      - url: ${GRAFANA_REMOTE_WRITE_URL}
        basic_auth:
          username: ${GRAFANA_REMOTE_WRITE_USER}
          password: ${GRAFANA_REMOTE_WRITE_PASSWORD}
    metric_relabel_configs:
      - source_labels: [ __name__ ]
        regex: 'go_.*'
        action: drop

  configs:
    - name: integrations
      scrape_configs:
        - job_name: 'postgres'
          static_configs:
            - targets: ['postgres-exporter:9187']
          metric_relabel_configs:
            - source_labels: [ __name__ ]
              regex: 'go_.*'
              action: drop

        - job_name: 'cadvisor'
          static_configs:
            - targets: [ 'cadvisor:8080' ]

        - job_name: 'node_exporter'
          static_configs:
            - targets: ['node-exporter:9100']

        - job_name: 'api-client'
          metrics_path: /metrics
          static_configs:
            - targets: ['api-client:8080']